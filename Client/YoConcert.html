<html>
    <head>
        <title>Yoconcert - Explore Yogyakarta</title>
        <link rel="icon" href="../Image/Logo Yoxplore.png" type="image/png">
        <link rel="stylesheet" href="../Style/Yoconcert.css">
    </head>
    <body>
        <header>
            <nav class="container">
                <a href="/Client/Home.html"><img class="logo" src="../Image/Yoxplore logo text.png" alt="Yoxplore Logo"></a>
                <div class="nav-links">
                    <a href="../Client/Home.html"><img src="../Image/home.png" alt="Home Icon"> Home</a>
                    <a href="../Client/YoTrip.html"><img src="../Image/yotrip.png" alt="Trip Icon"> YoTrip</a>
                    <a href="../Client/YoConcert.html" class="active"><img src="../Image/yoconcert.png" alt="Concert Icon"> YoShow</a>
                    <a href="../Client/YoTaste.html"><img src="../Image/yotaste.png" alt="Taste Icon"> YoTaste</a>
                    <a href="../Client/YoStay.html"><img src="../Image/yostay.png" alt="Stay Icon"> YoStay</a>
                </div>
                <div class="user-profile">
                    <span id="usernameDisplay"></span></div>
                <div class="profile-dropdown">
                    <div class="profile-icon" onclick="toggleDropdown()">
                        <img src="../Image/user.png" alt="Profile Icon">
                    </div>
                    <div id="dropdown-menu" class="dropdown-menu">
                        <a href="../Client/Profile.html" class="menu-item">
                            <img src="../Image/navbar/settings.png" alt="Settings Icon">
                            Account 
                        </a>
                        <a href="../Client/Login.html" onclick="logout()" class="menu-item logout">
                            <img src="../Image/navbar/logout.png" alt="Logout Icon">
                            Logout
                        </a>
                    </div>
                </div>  
            </nav>
        </header>

        <div class="container">
            <section class="hero">
                <div class="text">
                    <h2>Lets cultivate the culture!</h2>
                    <p>Find the best and spectacular show in Yogyakarta.</p>
                </div>
                <div class="search-bar">
                    <input type="text" placeholder="where you want to go?" />
                    <a href="#"><img src="../Image/search.png">Search</a>
                </div>
            </section>
        </div>

        <div class="container3">
            <section class="most-popular">
                <div class="header-section">
                    <h2>Our Recommendation</h2>
                    <div class="shorted-by">
                        <label for="sort-options">Shorted by:</label>
                        <select id="sort-options">
                            <option value="">All</option>
                            <option value="Traditional">Traditional</option>
                            <option value="Modern">Modern</option>
                            <option value="Festival">Festival</option>
                        </select>
                    </div>
                </div>
                <div class="popular-grid">
                    
                </div>
            </section>
        </div> 

        <footer class="footer">
            <div class="contact-info">
                <h3>Contact us</h3>
                <ul>
                    <li><img src="../Image/footer/clock.png" alt="Clock" class="icon"> Monday - Friday, 09:00 - 17:00</li>
                    <li><img src="../Image/footer/email.png" alt="Email" class="icon"> Email: <a href="mailto:yoxplore@gmail.com">yoxplore@gmail.com</a></li>
                    <li><img src="../Image/footer/phone-call.png" alt="Phone" class="icon"> Phone: 08123456789</li>
                    <li><img src="../Image/yotrip.png" alt="Location" class="icon"> Universitas Islam Indonesia,</li>
                    <div class="alamat">
                        Gedung K.H. Mas Mansyur, <br>
                        Daerah Istimewa Yogyakarta 55584
                    </div>
                </ul>
            </div>
            
            <div class="products">
                <h3>Products</h3>
                <ul>
                    <li><a href="/Client/Yotrip.html">YoTrip</a></li>
                    <li><a href="/Client/Yotaste.html">YoTaste</a></li>
                    <li><a href="/Client/Yoconcert.html">YoConcert</a></li>
                    <li><a href="/Client/Yostay.html">YoStay</a></li>
                </ul>
            </div>
            <div class="social-media">
                <h3>Follow us on</h3>
                <ul>
                    <li class="icon"><img src="../Image/footer/sosmed/instagram.png" alt="Instagram">Instagram</li>
                    <li class="icon"><img src="../Image/footer/sosmed/tik-tok.png" alt="TikTok">TikTok</li>
                    <li class="icon"><img src="../Image/footer/sosmed/twitter.png" alt="Twitter">X</li>
                    <li class="icon"><img src="../Image/footer/sosmed/youtube.png" alt="YouTube">YouTube</li>
                    <li class="icon"><img src="../Image/footer/sosmed/facebook.png" alt="Facebook">Facebook</li>
                    <li class="icon"><img src="../Image/footer/sosmed/telegram.png" alt="Telegram">Telegram</li>
                </ul>
            </div>
            <div class="copyright">
                Copyright &copy; 2024 Yoxplore. All rights reserved
            </div>
        </footer>
    </body>
    <script>

        function logout() {
            // Clear semua data
            sessionStorage.clear();
            localStorage.clear();
            window.location.href = '../Client/Login.html';
        }

        document.addEventListener('DOMContentLoaded', function() {
            const usernameDisplay = document.getElementById('usernameDisplay');
            fetch('/YoXplore/Controller/get_user_data.php')
                .then(response => response.json())
                .then(data => {
                    if(data.username) {
                        usernameDisplay.textContent = data.username;

                        if (data.profileImage) {
                            const navbarProfileIcon = document.querySelector('.profile-icon img');
                            if (navbarProfileIcon) {
                                navbarProfileIcon.src = data.profileImage;
                                navbarProfileIcon.style.borderRadius = '50%';
                                navbarProfileIcon.style.width = '40px';
                                navbarProfileIcon.style.height = '40px';
                                navbarProfileIcon.style.objectFit = 'cover';
                            }
                        }
                    }
                });
        });
        
            // Load profile image berdasarkan user_id
            const userId = sessionStorage.getItem('user_id');
            const profileImage = localStorage.getItem(`profileImage_${userId}`);
            
            if (profileImage) {
                const navbarProfileIcon = document.querySelector('.profile-icon img');
                if (navbarProfileIcon) {
                    navbarProfileIcon.src = profileImage;
                    navbarProfileIcon.style.borderRadius = '50%';
                    navbarProfileIcon.style.width = '40px';
                    navbarProfileIcon.style.height = '40px';
                    navbarProfileIcon.style.objectFit = 'cover';
                }
            }
        
        // Fungsi toggle dropdown tetap sama
        function toggleDropdown() {
            const dropdown = document.getElementById('dropdown-menu');
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }
        
        // Menutup dropdown jika klik di luar area
        window.onclick = function (event) {
            if (!event.target.closest('.profile-dropdown')) {
                const dropdown = document.getElementById('dropdown-menu');
                if (dropdown) {
                    dropdown.style.display = 'none';
                }
            }
        };

        function loadConcerts() {
            fetch('../Controller/get_destinations.php?section=YoConcert')
                .then(response => response.json())
                .then(result => {
                    if (result.success && Array.isArray(result.data)) {
                        const container = document.querySelector('.popular-grid');
                        container.innerHTML = ''; // Clear existing content
                        
                        result.data.forEach(item => {
                            const itemHtml = `
                                <div class="popular-item">
                                    <div class="image-container">
                                        <a href="Item.html?id=${item.id}">
                                            <img src="data:image/jpeg;base64,${item.main_image || ''}" 
                                                 alt="${item.name}"
                                                 onerror="this.src='../Image/placeholder.jpg'">
                                            <div class="rating">
                                                <span>â˜… ${item.rating || '0'}</span>
                                            </div>
                                        </a>
                                    </div>
                                    <div class="content">
                                        <h3>${item.name}</h3>
                                        <div class="location">
                                            <img src="../Image/location_brown.png" alt="Location Icon">
                                            <span>${item.address}</span>
                                        </div>
                                        <div class="time-info">
                                            <img src="../Image/clock.png" alt="Time Icon">
                                            <span>${item.opening_hours || '--:--'} - ${item.closing_hours || '--:--'}</span>
                                        </div>
                                    </div>
                                </div>
                            `;
                            container.innerHTML += itemHtml;
                        });
                    } else {
                        console.error('Failed to load concerts:', result);
                    }
                })
                .catch(error => {
                    console.error('Error loading concerts:', error);
                });
        }
        
        // Load concerts when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadConcerts();
            
            // Handle category filter
            const sortOptions = document.getElementById('sort-options');
            if (sortOptions) {
                sortOptions.addEventListener('change', function() {
                    const category = this.value;
                    loadConcerts(category);
                });
            }
        });
    </script>
</html>